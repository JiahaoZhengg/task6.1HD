{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\ben\\\\Desktop\\\\task8.1D\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\ben\\\\Desktop\\\\task8.1D\\\\src\\\\MyHome\\\\myHome.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { db } from \"../utils/firebase.js\";\nimport { getDoc, doc, updateDoc, arrayUnion, arrayRemove } from \"firebase/firestore\";\nimport \"./myHome.css\";\nvar userInfo = JSON.parse(sessionStorage.getItem(\"userInfo\"));\nvar flag = 1;\n\nfunction MyHome() {\n  var _this = this;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      message = _useState2[0],\n      setMessage = _useState2[1];\n\n  useEffect(function () {\n    if (flag) {\n      var docRef = doc(db, \"User\", userInfo.id);\n      getDoc(docRef).then(function (result) {\n        var message = [];\n        var data = result.data();\n        data.message.forEach(function (item) {\n          var obj = JSON.parse(item);\n\n          if (obj.status === \"1\") {\n            message.push(obj);\n          }\n        });\n        flag = 0;\n        setMessage(message);\n      }).catch(function (error) {});\n    }\n  });\n\n  function detail(item) {\n    console.log(item);\n    var washingtonRef = doc(db, \"User\", userInfo.id);\n    updateDoc(washingtonRef, {\n      message: arrayUnion(JSON.stringify({\n        time: item.time,\n        video: item.video,\n        status: 0\n      }))\n    }).then(function () {\n      updateDoc(washingtonRef, {\n        message: arrayRemove(JSON.stringify(item))\n      });\n    }).then(function () {}).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"my-home\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"nav\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 30\n    }\n  }, \"Home\")), /*#__PURE__*/React.createElement(Link, {\n    to: \"/findQuestion\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 42\n    }\n  }, \"find question\")), /*#__PURE__*/React.createElement(Link, {\n    to: \"/tutorial\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 38\n    }\n  }, \"tutorial\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"userInfo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 17\n    }\n  }, \"\\u4E2A\\u4EBA\\u4FE1\\u606F\"), [\"username\", \"email\"].map(function (info) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 32\n      }\n    }, info, \": \", userInfo[info]);\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"myMessage\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }, \"System Message\"), message.map(function (item) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"messageItem\",\n      onClick: function onClick() {\n        detail(item);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 32\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 29\n      }\n    }, \"time: \", new Date(Number(item.time)).toString()), /*#__PURE__*/React.createElement(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 29\n      }\n    }, \"type: good\"), /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        color: \"green\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 29\n      }\n    }, \"new message!\"));\n  })));\n}\n\nexport default MyHome;","map":{"version":3,"names":["React","useState","useEffect","Link","db","getDoc","doc","updateDoc","arrayUnion","arrayRemove","userInfo","JSON","parse","sessionStorage","getItem","flag","MyHome","message","setMessage","docRef","id","then","result","data","forEach","item","obj","status","push","catch","error","detail","console","log","washingtonRef","stringify","time","video","map","info","Date","Number","toString","color"],"sources":["C:/Users/ben/Desktop/task8.1D/src/MyHome/myHome.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { db } from \"../utils/firebase.js\";\r\nimport { getDoc, doc, updateDoc, arrayUnion, arrayRemove } from \"firebase/firestore\";\r\n\r\nimport \"./myHome.css\";\r\n\r\nconst userInfo = JSON.parse(sessionStorage.getItem(\"userInfo\"));\r\n\r\nlet flag = 1;\r\n\r\nfunction MyHome() {\r\n\r\n    const [message, setMessage] = useState([]);\r\n\r\n    useEffect(() => {\r\n        if (flag) {\r\n            const docRef = doc(db, \"User\", userInfo.id);\r\n            getDoc(docRef).then(result => {\r\n                const message = [];\r\n                let data = result.data();\r\n                data.message.forEach(item => {\r\n                    let obj = JSON.parse(item);\r\n                    if (obj.status === \"1\") {\r\n                        message.push(obj);\r\n                    }\r\n                })\r\n                flag = 0;\r\n                setMessage(message);\r\n            }).catch(error => { });\r\n        }\r\n    });\r\n\r\n    function detail(item) {\r\n        console.log(item);\r\n        const washingtonRef = doc(db, \"User\", userInfo.id);\r\n\r\n        updateDoc(washingtonRef, {\r\n            message: arrayUnion(JSON.stringify({\r\n                time: item.time,\r\n                video: item.video,\r\n                status: 0\r\n            }))\r\n        }).then(() => {\r\n            updateDoc(washingtonRef, {\r\n                message: arrayRemove(JSON.stringify(item))\r\n            })\r\n        }).then(() => {\r\n\r\n        }).catch(error => {\r\n            console.log(error);\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div className=\"my-home\">\r\n            <div className=\"nav\">\r\n                <Link to='/'><span>Home</span></Link>\r\n                <Link to='/findQuestion'><span>find question</span></Link>\r\n                <Link to='/tutorial'><span>tutorial</span></Link>\r\n            </div>\r\n            <div className=\"userInfo\">\r\n                <h3>个人信息</h3>\r\n                {\r\n                    [\"username\", \"email\"].map(info => {\r\n                        return <div>{info}: {userInfo[info]}</div>;\r\n                    })\r\n                }\r\n            </div>\r\n\r\n            <div className=\"myMessage\">\r\n                <h3>System Message</h3>\r\n                {\r\n                    message.map(item => {\r\n                        return <div className=\"messageItem\" onClick={() => { detail(item) }}>\r\n                            <span>time: {(new Date(Number(item.time))).toString()}</span>\r\n                            <span>type: good</span>\r\n                            <span style={{ color: \"green\" }}>new message!</span>\r\n                        </div>;\r\n                    })\r\n                }\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default MyHome"],"mappings":"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"},"metadata":{},"sourceType":"module"}